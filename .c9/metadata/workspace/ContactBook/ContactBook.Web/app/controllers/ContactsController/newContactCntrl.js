{"changed":true,"filter":false,"title":"newContactCntrl.js","tooltip":"/ContactBook/ContactBook.Web/app/controllers/ContactsController/newContactCntrl.js","value":"(function() {\n    'use strict';\n\n    cbControllers.controller('newContactCntrl', ['$scope', '$filter', '$modal', '$log', 'contactsSvc', function($scope, $filter, $modal, $log, contactsSvc) {\n        var serverObjects = [];\n\n        $scope.search = '';\n        $scope.letterList = [];\n        $scope.selectedLetter = '*';\n\n        //Pagination variables\n        $scope.totalItems = 0;\n        $scope.currentPage = 1;\n        $scope.maxSize = 10;\n        $scope.itemPerPage = 12;\n\n        /*\n         * init method make service call to get all the contacts\n         */\n        var init = function() {\n            populateLetters();\n            contactsSvc.GetContacts().then(onSuccess, onError);\n            $scope.onlyNumbers = /^\\d+$/;\n        };\n\n        var onSuccess = function(data) {\n            serverObjects = angular.copy(data.data);\n\n            if (angular.isDefined(serverObjects)) {\n                loadContacts(serverObjects);\n            }\n        };\n\n        var onError = function(err) {\n            $log.error('error had occoured');\n        };\n\n        var loadContacts = function(objs) {\n            $scope.contactList = [];\n            $scope.pagedContactList = [];\n\n            angular.forEach(objs, function(value, key) {\n                $scope.contactList.push(value);\n            });\n\n            $scope.totalItems = $scope.contactList.length;\n            $scope.pagedContactList = _.chunk($scope.contactList, $scope.itemPerPage)[$scope.currentPage - 1];\n\n        };\n\n        var populateLetters = function() {\n            $scope.letterList.push('*');\n            for (var i = 65; i < 91; i++) {\n                $scope.letterList.push(String.fromCharCode(i));\n            }\n        };\n\n        var hasItemForSelectedLetter = function(letter){\n             var newArray = $filter('letterFilter')(serverObjects, letter);\n             return newArray.length >= 1;\n        };\n        \n        $scope.searchContact = function(search) {\n            var newArray = $filter('filter')(serverObjects, search);\n            $scope.currentPage = 1;\n            loadContacts(newArray);\n            $scope.selectedLetter = $scope.letterList[0];\n        };\n\n        $scope.searchByLetter = function(letter, setToFristPage) {\n            var newArray = $filter('letterFilter')(serverObjects, letter);\n            if (setToFristPage) {\n                $scope.currentPage = 1;\n            }\n            loadContacts(newArray);\n            $scope.selectedLetter = letter;\n        }\n\n        $scope.pageChanged = function() {\n            $scope.pagedContactList = _.chunk($scope.contactList, $scope.itemPerPage)[$scope.currentPage - 1];\n        };\n\n        $scope.clearSearchBox = function() {\n            $scope.search = {\n                name: '',\n                phone: '',\n                email: ''\n            };\n        };\n\n        $scope.open = function(sz, openContact) {\n            var modalInstance = $modal.open({\n                templateUrl: 'deleteModalContent.html',\n                controller: 'deleteModalCntrl',\n                animation: true,\n                size: sz,\n                backdrop: 'static',\n                //backdropClass: 'modal-backdrop h-full',\n                resolve: {\n                    contact: function() {\n                        var Id = openContact.id;\n                        return Id;\n\n                    }\n                }\n            });\n\n            modalInstance.result.then(function(contactId) {\n                var tempServerObj = [];\n                $log.info('Delete contact with contact id : ' + contactId);\n\n                angular.forEach(serverObjects, function(value, key) {\n                    if (contactId !== value.id) {\n                        tempServerObj.push(value);\n                    }\n                });\n\n                serverObjects = tempServerObj;\n                \n                if ($scope.selectedLetter !== '*') {\n                    if(!hasItemForSelectedLetter($scope.selectedLetter)){\n                        $scope.selectedLetter = '*';\n                        $scope.currentPage = 1;\n                        loadContacts(serverObjects);                        \n                    }else{\n                        $scope.searchByLetter($scope.selectedLetter, false);                        \n                    }\n                }\n                else {\n                    loadContacts(serverObjects);\n                }\n                \n            }, function(err) {\n                $log.error(err.message);\n            });\n        };\n\n        init();\n    }]);\n\n    cbControllers.controller('deleteModalCntrl', ['$scope', '$modalInstance', 'contact', function($scope, $modalInstance, contact) {\n\n        $scope.contactId = contact;\n\n        $scope.ok = function() {\n            $modalInstance.close($scope.contactId);\n        };\n\n        $scope.cancel = function() {\n            $modalInstance.dismiss('cancelled');\n        };\n    }]);\n\n})();","undoManager":{"mark":99,"position":100,"stack":[[{"start":{"row":120,"column":42},"end":{"row":120,"column":43},"action":"remove","lines":["e"],"id":4266}],[{"start":{"row":120,"column":41},"end":{"row":120,"column":42},"action":"remove","lines":["t"],"id":4267}],[{"start":{"row":120,"column":40},"end":{"row":120,"column":41},"action":"remove","lines":["t"],"id":4268}],[{"start":{"row":120,"column":39},"end":{"row":120,"column":40},"action":"remove","lines":["e"],"id":4269}],[{"start":{"row":120,"column":38},"end":{"row":120,"column":39},"action":"remove","lines":["L"],"id":4270}],[{"start":{"row":120,"column":38},"end":{"row":120,"column":39},"action":"insert","lines":["d"],"id":4271}],[{"start":{"row":120,"column":31},"end":{"row":120,"column":39},"action":"remove","lines":["selected"],"id":4272},{"start":{"row":120,"column":31},"end":{"row":120,"column":45},"action":"insert","lines":["selectedLetter"]}],[{"start":{"row":120,"column":45},"end":{"row":120,"column":46},"action":"insert","lines":[" "],"id":4273}],[{"start":{"row":120,"column":46},"end":{"row":120,"column":47},"action":"insert","lines":["="],"id":4274}],[{"start":{"row":120,"column":47},"end":{"row":120,"column":48},"action":"insert","lines":[" "],"id":4275}],[{"start":{"row":120,"column":48},"end":{"row":120,"column":50},"action":"insert","lines":["''"],"id":4276}],[{"start":{"row":120,"column":49},"end":{"row":120,"column":50},"action":"insert","lines":["*"],"id":4277}],[{"start":{"row":120,"column":51},"end":{"row":120,"column":52},"action":"insert","lines":[";"],"id":4278}],[{"start":{"row":121,"column":20},"end":{"row":121,"column":24},"action":"insert","lines":["    "],"id":4279}],[{"start":{"row":122,"column":21},"end":{"row":122,"column":22},"action":"insert","lines":["e"],"id":4280}],[{"start":{"row":122,"column":22},"end":{"row":122,"column":23},"action":"insert","lines":["l"],"id":4281}],[{"start":{"row":122,"column":23},"end":{"row":122,"column":24},"action":"insert","lines":["s"],"id":4282}],[{"start":{"row":122,"column":24},"end":{"row":122,"column":25},"action":"insert","lines":["e"],"id":4283}],[{"start":{"row":122,"column":25},"end":{"row":122,"column":26},"action":"insert","lines":["{"],"id":4284}],[{"start":{"row":122,"column":26},"end":{"row":124,"column":21},"action":"insert","lines":["","                        ","                    }"],"id":4285}],[{"start":{"row":125,"column":0},"end":{"row":125,"column":65},"action":"remove","lines":["                    searchByLetter($scope.selectedLetter, false);"],"id":4286}],[{"start":{"row":123,"column":0},"end":{"row":123,"column":65},"action":"insert","lines":["                    searchByLetter($scope.selectedLetter, false);"],"id":4287}],[{"start":{"row":124,"column":21},"end":{"row":125,"column":0},"action":"remove","lines":["",""],"id":4288}],[{"start":{"row":123,"column":20},"end":{"row":123,"column":24},"action":"insert","lines":["    "],"id":4289}],[{"start":{"row":128,"column":17},"end":{"row":129,"column":0},"action":"remove","lines":["",""],"id":4290}],[{"start":{"row":128,"column":17},"end":{"row":129,"column":0},"action":"insert","lines":["",""],"id":4291},{"start":{"row":129,"column":0},"end":{"row":129,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":120,"column":52},"end":{"row":121,"column":0},"action":"insert","lines":["",""],"id":4292},{"start":{"row":121,"column":0},"end":{"row":121,"column":24},"action":"insert","lines":["                        "]}],[{"start":{"row":121,"column":24},"end":{"row":121,"column":25},"action":"insert","lines":["$"],"id":4293}],[{"start":{"row":121,"column":25},"end":{"row":121,"column":26},"action":"insert","lines":["s"],"id":4294}],[{"start":{"row":121,"column":26},"end":{"row":121,"column":27},"action":"insert","lines":["c"],"id":4295}],[{"start":{"row":121,"column":27},"end":{"row":121,"column":28},"action":"insert","lines":["o"],"id":4296}],[{"start":{"row":121,"column":28},"end":{"row":121,"column":29},"action":"insert","lines":["p"],"id":4297}],[{"start":{"row":121,"column":29},"end":{"row":121,"column":30},"action":"insert","lines":["e"],"id":4298}],[{"start":{"row":121,"column":30},"end":{"row":121,"column":31},"action":"insert","lines":["."],"id":4299}],[{"start":{"row":121,"column":31},"end":{"row":121,"column":32},"action":"insert","lines":["c"],"id":4300}],[{"start":{"row":121,"column":32},"end":{"row":121,"column":33},"action":"insert","lines":["u"],"id":4301}],[{"start":{"row":121,"column":33},"end":{"row":121,"column":34},"action":"insert","lines":["r"],"id":4302}],[{"start":{"row":121,"column":31},"end":{"row":121,"column":34},"action":"remove","lines":["cur"],"id":4303},{"start":{"row":121,"column":31},"end":{"row":121,"column":42},"action":"insert","lines":["currentPage"]}],[{"start":{"row":121,"column":42},"end":{"row":121,"column":43},"action":"insert","lines":[" "],"id":4304}],[{"start":{"row":121,"column":43},"end":{"row":121,"column":44},"action":"insert","lines":["="],"id":4305}],[{"start":{"row":121,"column":44},"end":{"row":121,"column":45},"action":"insert","lines":[" "],"id":4306}],[{"start":{"row":121,"column":45},"end":{"row":121,"column":46},"action":"insert","lines":["1"],"id":4307}],[{"start":{"row":121,"column":46},"end":{"row":121,"column":47},"action":"insert","lines":[";"],"id":4308}],[{"start":{"row":124,"column":24},"end":{"row":124,"column":25},"action":"insert","lines":["$"],"id":4309}],[{"start":{"row":124,"column":25},"end":{"row":124,"column":26},"action":"insert","lines":["s"],"id":4310}],[{"start":{"row":124,"column":26},"end":{"row":124,"column":27},"action":"insert","lines":["c"],"id":4311}],[{"start":{"row":124,"column":27},"end":{"row":124,"column":28},"action":"insert","lines":["o"],"id":4312}],[{"start":{"row":124,"column":28},"end":{"row":124,"column":29},"action":"insert","lines":["p"],"id":4313}],[{"start":{"row":124,"column":29},"end":{"row":124,"column":30},"action":"insert","lines":["e"],"id":4314}],[{"start":{"row":124,"column":30},"end":{"row":124,"column":31},"action":"insert","lines":["."],"id":4315}],[{"start":{"row":124,"column":24},"end":{"row":124,"column":31},"action":"remove","lines":["$scope."],"id":4316}],[{"start":{"row":124,"column":24},"end":{"row":124,"column":31},"action":"insert","lines":["$scope."],"id":4317,"ignore":true}],[{"start":{"row":21,"column":63},"end":{"row":22,"column":0},"action":"insert","lines":["",""],"id":4318},{"start":{"row":22,"column":0},"end":{"row":22,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":22,"column":12},"end":{"row":22,"column":13},"action":"insert","lines":["$"],"id":4319}],[{"start":{"row":22,"column":13},"end":{"row":22,"column":14},"action":"insert","lines":["s"],"id":4320}],[{"start":{"row":22,"column":14},"end":{"row":22,"column":15},"action":"insert","lines":["c"],"id":4321}],[{"start":{"row":22,"column":15},"end":{"row":22,"column":16},"action":"insert","lines":["o"],"id":4322}],[{"start":{"row":22,"column":16},"end":{"row":22,"column":17},"action":"insert","lines":["p"],"id":4323}],[{"start":{"row":22,"column":17},"end":{"row":22,"column":18},"action":"insert","lines":["e"],"id":4324}],[{"start":{"row":22,"column":18},"end":{"row":22,"column":19},"action":"insert","lines":["."],"id":4325}],[{"start":{"row":22,"column":19},"end":{"row":22,"column":20},"action":"insert","lines":["o"],"id":4326}],[{"start":{"row":22,"column":20},"end":{"row":22,"column":21},"action":"insert","lines":["n"],"id":4327}],[{"start":{"row":22,"column":21},"end":{"row":22,"column":22},"action":"insert","lines":["l"],"id":4328}],[{"start":{"row":22,"column":22},"end":{"row":22,"column":23},"action":"insert","lines":["y"],"id":4329}],[{"start":{"row":22,"column":23},"end":{"row":22,"column":24},"action":"insert","lines":["N"],"id":4330}],[{"start":{"row":22,"column":24},"end":{"row":22,"column":25},"action":"insert","lines":["u"],"id":4331}],[{"start":{"row":22,"column":25},"end":{"row":22,"column":26},"action":"insert","lines":["m"],"id":4332}],[{"start":{"row":22,"column":26},"end":{"row":22,"column":27},"action":"insert","lines":["b"],"id":4333}],[{"start":{"row":22,"column":27},"end":{"row":22,"column":28},"action":"insert","lines":["e"],"id":4334}],[{"start":{"row":22,"column":28},"end":{"row":22,"column":29},"action":"insert","lines":["r"],"id":4335}],[{"start":{"row":22,"column":29},"end":{"row":22,"column":30},"action":"insert","lines":[" "],"id":4336}],[{"start":{"row":22,"column":30},"end":{"row":22,"column":31},"action":"insert","lines":["s"],"id":4337}],[{"start":{"row":22,"column":30},"end":{"row":22,"column":31},"action":"remove","lines":["s"],"id":4338}],[{"start":{"row":22,"column":29},"end":{"row":22,"column":30},"action":"remove","lines":[" "],"id":4339}],[{"start":{"row":22,"column":29},"end":{"row":22,"column":30},"action":"insert","lines":["s"],"id":4340}],[{"start":{"row":22,"column":30},"end":{"row":22,"column":31},"action":"insert","lines":[" "],"id":4341}],[{"start":{"row":22,"column":31},"end":{"row":22,"column":32},"action":"insert","lines":[" "],"id":4342}],[{"start":{"row":22,"column":31},"end":{"row":22,"column":32},"action":"remove","lines":[" "],"id":4343}],[{"start":{"row":22,"column":31},"end":{"row":22,"column":32},"action":"insert","lines":["="],"id":4344}],[{"start":{"row":22,"column":32},"end":{"row":22,"column":33},"action":"insert","lines":[" "],"id":4345}],[{"start":{"row":22,"column":33},"end":{"row":22,"column":35},"action":"insert","lines":["''"],"id":4346}],[{"start":{"row":22,"column":35},"end":{"row":22,"column":36},"action":"insert","lines":[";"],"id":4347}],[{"start":{"row":22,"column":34},"end":{"row":22,"column":35},"action":"insert","lines":["/"],"id":4348}],[{"start":{"row":22,"column":35},"end":{"row":22,"column":36},"action":"insert","lines":["^"],"id":4349}],[{"start":{"row":22,"column":36},"end":{"row":22,"column":37},"action":"insert","lines":["/"],"id":4350}],[{"start":{"row":22,"column":37},"end":{"row":22,"column":38},"action":"insert","lines":["E"],"id":4351}],[{"start":{"row":22,"column":37},"end":{"row":22,"column":38},"action":"remove","lines":["E"],"id":4352}],[{"start":{"row":22,"column":36},"end":{"row":22,"column":37},"action":"remove","lines":["/"],"id":4353}],[{"start":{"row":22,"column":36},"end":{"row":22,"column":37},"action":"insert","lines":["\\"],"id":4354}],[{"start":{"row":22,"column":37},"end":{"row":22,"column":38},"action":"insert","lines":["d"],"id":4355}],[{"start":{"row":22,"column":38},"end":{"row":22,"column":39},"action":"insert","lines":["+"],"id":4356}],[{"start":{"row":22,"column":39},"end":{"row":22,"column":40},"action":"insert","lines":["S"],"id":4357}],[{"start":{"row":22,"column":40},"end":{"row":22,"column":41},"action":"insert","lines":["\\"],"id":4358}],[{"start":{"row":22,"column":40},"end":{"row":22,"column":41},"action":"remove","lines":["\\"],"id":4359}],[{"start":{"row":22,"column":39},"end":{"row":22,"column":40},"action":"remove","lines":["S"],"id":4360}],[{"start":{"row":22,"column":39},"end":{"row":22,"column":40},"action":"insert","lines":["$"],"id":4361}],[{"start":{"row":22,"column":40},"end":{"row":22,"column":41},"action":"insert","lines":["\\"],"id":4362}],[{"start":{"row":22,"column":40},"end":{"row":22,"column":41},"action":"remove","lines":["\\"],"id":4363}],[{"start":{"row":22,"column":40},"end":{"row":22,"column":41},"action":"insert","lines":["/"],"id":4364}],[{"start":{"row":22,"column":33},"end":{"row":22,"column":42},"action":"remove","lines":["'/^\\d+$/'"],"id":4365},{"start":{"row":22,"column":33},"end":{"row":22,"column":41},"action":"insert","lines":["/^\\d+$/;"]}],[{"start":{"row":22,"column":40},"end":{"row":22,"column":41},"action":"remove","lines":[";"],"id":4366}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":22,"column":40},"end":{"row":22,"column":40},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1445160014660}